#!/bin/sh

mountusb() {
	chosen="$(echo "$usbdrives" | dmenu -i -p "Mount which drive?")" || exit 1
	chosen="$(echo "$chosen" | awk '{print $1}')"
	loc=$(udisksctl mount -b $chosen)
	loc=${loc##*at}
	echo $loc | xclip -sel clip
	notify-send "üíª USB mounting" "$chosen mounted to $loc."
	setsid st -e lf $loc
}

# anddrives=$(simple-mtpfs -l 2>/dev/null)
usbdrives=$(lsblk -rpo "name,type,size,mountpoint" | grep 'part\|rom' | awk '$4==""{printf "%s (%s)\n",$1,$3}')

echo "drivers ${usbdrives[@]}"

if [ -z "$usbdrives" ]; then
	notify-send "‚ö†Ô∏è No USB drive detected ‚ö†Ô∏è"
else
	echo "USB drive(s) detected."
	mountusb
fi
